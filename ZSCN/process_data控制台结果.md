O:\Software\Anaconda3\python.exe O:\Workfile-Code\Python\GraduateProject\process_data.py 
==================================================
南昌昌北机场航班数据处理系统
毕业论文·第二章 数据基础与处理
==================================================
📂 正在读取: data\khn_flight.xlsx
✅ 读取成功: 8631行 × 10列

🧹 开始数据清洗...
   删除缺失值: 0 条记录
   删除重复值: 1 条记录
   标记异常值: 191 条记录（|delayMin|>180）
   标记取消: 0 条记录
✅ 清洗完成，剩余: 8630 条记录

🔧 正在衍生新字段...
✅ 衍生字段完成

📊 正在评估数据质量...
    评估维度     指标值                              处理说明
    记录总数  8,630条                    删除2条记录与无效字段后保留
  缺失率(%)   0.00%             关键字段（航班号、delayMin）无缺失
  异常率(%)   2.21% 191条|delayMin|>180分钟（对应极端天气，保留标注）
 取消占比(%)   0.00%            0条实际起飞时间为NaT（本样本无取消航班）
  重复率(%)   0.03%                   按航班号+计划起飞时间联合去重
日期有效性(%) 100.00% 所有记录计划时间落在2025-07-01至2025-07-31区间

📈 正在生成统计表格...

💾 正在保存表格...
✅ 所有表格已保存至: output\tables

🎨 正在生成图2-1...
  总样本: 8,630条 | 提前起飞: 808条 (9.4%) | 延误: 7,822条
✅ 图表已保存: output\figures\图2-1_delayMin直方图.png

📊 可视化验证:
   有效刻度数量: 31
   全样本中位数: 11min
>15分钟延误占比: 40.1%

==================================================
🎉 全部处理完成！
==================================================
📁 处理后的数据: output\khn_flight_processed.xlsx
📊 统计表格: output\tables
🖼️  图表: output\figures

📋 最终数据规模:
   总记录数: 8630 条
   航司数量: 31 家
   机型数量: 57 种

📊 核心统计量验证（与论文表2-5/2-6核对）:
   全样本中位数: 11 分钟
   全样本均值: 58.7 分钟
   延误子集中位数: 14 分钟
   东方航空样本量: 2363 条 (论文表2-5: 2363)
   A320-214样本量: 2216 条 (论文表2-6: 2216)

Process finished with exit code 0